<div >
  <%current_user.user_banks.each{|user_bank| %>
    <%=link_to user_bank.name, nil, href:'javascript:void(0)', class:"btn btn-primary", onclick:"select_bank('#{user_bank.id}', '#{user_bank.to_json}');"%>
  <%}%>
  <%=link_to "Add new card", nil, href:'javascript:void(0)', class:"btn btn-default", onclick:"select_bank('#{UserBank.new.id}', '#{UserBank.new.to_json}');"%><br />

  <%= better_form_for(@user_bank, :url=>{ :action=>"bind_bank"}, :method=>"post") do |f| %>
    <div class="form-inputs">
      <%=render 'my/account/bank_form_content', bank_form: f%>
    </div>
    <%submit_display=(@user_bank && @user_bank.persisted?) ? "display:none" : "display:block"%>
    <div class="form-actions" id="submit_div" style="<%=submit_display%>">
      <%= f.submit "bind bank", class:"btn" %>
    </div>
  <% end %>
</div>

<script>
  function select_bank(bank_id, user_bank_json){
    var user_bank = $.parseJSON(user_bank_json);
    var disable = true;
    if(bank_id==""){
      disable = false;
      $("#password_div").show();
      $("#submit_div").show();
    }else{
      $("#password_div").hide();
      $("#submit_div").hide();
    }
    $("#user_bank_name").val(user_bank.name).attr("disabled",disable);
    $("#user_bank_card_number").val(user_bank.card_number).attr("disabled",disable);
    $("#user_bank_branch_name").val(user_bank.branch_name).attr("disabled",disable);
    $("#user_bank_address").val(user_bank.address).attr("disabled",disable);
  }
</script>
